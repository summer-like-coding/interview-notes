---
title: 键入网址到页面显示，发生了什么？
author: summer
data: 2023-06-20
category:
    - Network 篇
tag:
    - Network
    - basic
---

### 浏览器解析

1. 浏览器会判断输入的网址是`搜索内容`还是`网址`，如果是搜索内容，浏览器会将其转换为`https://www.baidu.com/s?wd=搜索内容`的形式，然后再发送请求。
   **这边我们考虑的都是键入网址内容**

2. 浏览器会先检查本地缓存中是否有该网址对应的资源，如果有，就直接从缓存中获取资源，如果没有，就发送请求到服务器。

3. 浏览器会解析网址，获取协议、域名、端口号、路径、查询字符串、锚点等信息。

### DNS解析

1. 浏览器会先检查本地缓存中是否有该网址对应的`IP`地址，如果有，就直接从缓存中获取，如果没有，就发送请求到`DNS`服务器。
2. 向DNS发送请求采用的是迭代查询，即先向根域名服务器发送请求，根域名服务器会返回一个`IP`地址，然后再向该`IP`地址对应的服务器发送请求，该服务器会返回一个`IP`地址，然后再向该`IP`地址对应的服务器发送请求，直到最后返回一个`IP`地址。

**在DNS解析完成以后，就可以获取到目的网络的IP地址，这时候应用层就会生成相应的Http报文，然后从上往下传输到传输层**

### TCP连接
1. TCP在传输数据之前，要先进行三次握手，建立连接。
2. 双方建立好连接以后，就可以进行数据传输了。如果HTTP请求的消息体较大，TCP会将消息体分成多个数据包，然后在接收端再将其组装起来。
3. 将封装好的数据包传输到网络层。

### IP协议

1. IP协议需要将数据封装为数据包，然后发送到数据链路层。
2. IP协议需要知道源地址IP和目的地址IP，这两个地址都是IP地址，而不是域名。

### MAC地址

1. IP头部生成后，还需要在数据链路层生成MAC头部，MAC头部包含源MAC地址和目的MAC地址。
2. 发送方的MAC在网卡生产的时候就已经固定了，而接收方的MAC地址是通过ARP协议获取的。
3. `ARP`获取MAC地址的方式，是一种广播的方式，即发送方会向网络中的所有主机发送请求，询问目的主机的MAC地址，然后目的主机会向发送方回复MAC地址。**ARP为了提高效率，会有一个缓存**
4. 在数据链路层，数据包会被封装为帧吗，帧里面包含了MAC头部和IP头部，然后再发送到物理层。

### 网卡
1. 网卡会将数据包转换为电信号，然后通过网线发送出去，发送到路由器上。**也就是说，这才是真正的数据发送过程**

### 交换机
1. 交换机的端口因为无法获取到MAC地址，所以会将数据包转发到所有的端口，但是交换机会记录下数据包的源MAC地址和端口号，然后将其存储到MAC地址表中。
2. 所以交换机会根据MAC地址表，将数据包转发到目的主机。

### 路由器

1. 网络包经过交换机转发到路由器上，路由器会根据IP头部的目的IP地址，查找路由表，然后将数据包转发到下一个路由器。